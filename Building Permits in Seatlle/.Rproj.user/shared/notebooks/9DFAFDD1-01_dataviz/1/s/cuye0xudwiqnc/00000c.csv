"0","# Create a dataframe and computes the estimated cost of each unit"
"0","cost_per_unit <- permit_df %>% "
"0","  filter(PermitClassMapped == ""Residential"") %>%"
"0","  filter(HousingUnitsRemoved == 0) %>%"
"0","  filter(HousingUnitsAdded != 0 & HousingUnitsAdded != 'NA') %>%"
"0","  filter(EstProjectCost != 0 & EstProjectCost < 2000000) %>% # Exclude one value that would have affected the mean too much "
"0","  filter(PermitTypeMapped == ""Building"") %>%"
"0","  mutate(estCost_unit = EstProjectCost / HousingUnitsAdded)"
"0",""
"0","# Change the order of the legend for better visualization"
"0","cost_per_unit$PermitClass <- factor(cost_per_unit$PermitClass, levels = c(""Single Family/Duplex"", ""Multifamily""))"
"0",""
"0","# Create a histogram that shows the estimated cost per unit by class"
"0","ggplot(data = cost_per_unit,"
"0","       aes(x = estCost_unit, fill = PermitClass)) + "
"0","  geom_histogram(position=""identity"", alpha=0.5, binwidth = 100000) +"
"0","  geom_vline(aes(xintercept=mean(estCost_unit)),"
"0","            color=""blue"", linetype=""dashed"", size=1) +"
"0","  labs(title = ""Amount of Estimated Cost of Each Housing Unit by Class"","
"0","       x = ""Estimated Cost of Each Housing Unit"","
"0","       y = ""Count"") + "
"0","  labs(fill = ""Class of Permit"") +"
"0","  theme_bw() "
